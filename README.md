I have written the whole VBA code by myself. I have researched some formulae on the web but just the concept. I have shaped it to reflect the results I want.

Here is the link: https://learn.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.match

The whole VBA code is inside the MS Excek Macro-Enabled worksheet called Multiple_year_stock_data

I have tested the code and it works and gives the required results. In my code, I chose to loop from i=2 to lastrow even though it does check i+1. I did this so that it takes the last data as well directly. I found it easier to do it this way. 